import{a as u}from"./chunk-HGUJNCJE.js";import{a as V}from"./chunk-FNKDIBDA.js";import{$ as A,A as w,B as x,C as P,Da as z,Ea as B,F as l,G as j,Ga as W,H as g,J as _,K as I,L as M,Na as L,Oa as U,R as E,S as T,Ta as D,U as N,X as F,ab as G,bb as H,db as R,eb as $,fb as J,gb as q,hb as K,kb as Q,l as O,lb as X,m as y,pb as Y,qb as Z,r as d,s as p,t as S,u as m,w as c,wb as ee,x as s,xb as te,y as n,z as h}from"./chunk-ASIUTVEG.js";import"./chunk-MYMNFIR5.js";import"./chunk-QUJFQN2Y.js";import"./chunk-SQ2FC6MI.js";import"./chunk-MXQU5NIL.js";import"./chunk-RE5BQNDC.js";import"./chunk-WMOWL56E.js";import"./chunk-VZPOKD32.js";import"./chunk-DE3NY5IG.js";import"./chunk-GVUKRWTT.js";import"./chunk-7FY2OE2O.js";import"./chunk-V5RQBZ6Q.js";import"./chunk-TOLZJHI4.js";import"./chunk-3IV7M6SB.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-O6KNH33T.js";import"./chunk-CKP3SGE2.js";import"./chunk-IMAI2IPK.js";import"./chunk-PAKTAAC6.js";import"./chunk-BBW5KUYG.js";import"./chunk-677QIFDF.js";import"./chunk-G7CBOZIR.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as v,b as C,e as b}from"./chunk-JHI3MBHO.js";function ne(o,r){if(o&1&&(s(0,"ion-select-option",11),l(1),n()),o&2){let a=r.$implicit;c("value",a.subjectId),d(),g(" ",a.subjectName," ")}}function ie(o,r){if(o&1){let a=w();s(0,"div",14)(1,"div",15)(2,"div",16),l(3),n(),s(4,"div",17)(5,"div",18),l(6),n(),s(7,"div",19),l(8),n()()(),s(9,"div",20)(10,"ion-input",21),M("ngModelChange",function(e){let i=O(a).$implicit;return I(i.marksObtained,e)||(i.marksObtained=e),y(e)}),n()()()}if(o&2){let a=r.$implicit;d(3),g(" ",a.rollNo," "),d(3),j(a.studentName),d(2),g("Roll No: ",a.rollNo),d(2),_("ngModel",a.marksObtained),c("disabled",a.isAbsent)}}function oe(o,r){if(o&1&&(s(0,"div",2)(1,"h3",3),h(2,"ion-icon",12),l(3," Students "),n(),m(4,ie,11,5,"div",13),n()),o&2){let a=P();d(4),c("ngForOf",a.students)}}var be=(()=>{let r=class r{constructor(t,e,i){this.route=t,this.http=e,this.toast=i,this.subjects=[],this.students=[]}ngOnInit(){return b(this,null,function*(){this.examId=Number(this.route.snapshot.paramMap.get("examId")),this.classId=Number(this.route.snapshot.paramMap.get("classId"));let t=yield V.get({key:"user_profile"});this.schoolId=JSON.parse(t.value).schoolId,this.loadSubjects()})}loadSubjects(){this.http.get(`${u.apiBaseUrl}/Exam/GetSubjectsForMarks`,{params:{examId:this.examId,classId:this.classId}}).subscribe(t=>{this.subjects=t.data.subjects||[]})}loadStudents(){this.http.get(`${u.apiBaseUrl}/Exam/GetStudentsForMarks`,{params:{examId:this.examId,classId:this.classId,subjectId:this.subjectId,schoolId:this.schoolId}}).subscribe(t=>{this.students=(t.students||[]).map(e=>C(v({},e),{marksObtained:e.marksObtained??null,isAbsent:e.isAbsent??!1}))})}save(){let t={examId:this.examId,classId:this.classId,subjectId:this.subjectId,schoolId:this.schoolId,marks:this.students.filter(e=>e.isAbsent||e.marksObtained!==null).map(e=>({studentId:e.studentId,isAbsent:e.isAbsent,marksObtained:e.isAbsent?null:e.marksObtained}))};this.http.post(`${u.apiBaseUrl}/Exam/SaveMarks`,t).subscribe({next:()=>this.showToast("Marks saved successfully","success"),error:()=>this.showToast("Something went wrong","danger")})}showToast(t,e){return b(this,null,function*(){yield(yield this.toast.create({message:t,color:e,duration:2e3})).present()})}};r.\u0275fac=function(e){return new(e||r)(p(A),p(F),p(ee))},r.\u0275cmp=S({type:r,selectors:[["app-enter-marks"]],decls:19,vars:3,consts:[[1,"marks-header"],[1,"marks-page"],[1,"section-card"],[1,"section-title"],["name","book-outline"],["position","stacked"],["placeholder","Choose subject",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","section-card",4,"ngIf"],[1,"footer-bar"],["expand","block","color","success",3,"click"],[3,"value"],["name","people-outline"],["class","student-card",4,"ngFor","ngForOf"],[1,"student-card"],[1,"student-left"],[1,"roll-circle"],[1,"info"],[1,"name"],[1,"sub"],[1,"student-right"],["type","number","placeholder","Marks",1,"marks-input",3,"ngModelChange","ngModel","disabled"]],template:function(e,i){e&1&&(s(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),l(3,"Enter Marks"),n()()(),s(4,"ion-content",1)(5,"div",2)(6,"h3",3),h(7,"ion-icon",4),l(8," Select Subject "),n(),s(9,"ion-item")(10,"ion-label",5),l(11,"Subject"),n(),s(12,"ion-select",6),M("ngModelChange",function(f){return I(i.subjectId,f)||(i.subjectId=f),f}),x("ionChange",function(){return i.loadStudents()}),m(13,ne,2,2,"ion-select-option",7),n()()(),m(14,oe,5,1,"div",8),n(),s(15,"ion-footer")(16,"ion-toolbar",9)(17,"ion-button",10),x("click",function(){return i.save()}),l(18," Save Marks "),n()()()),e&2&&(d(12),_("ngModel",i.subjectId),d(),c("ngForOf",i.subjects),d(),c("ngIf",i.students.length))},dependencies:[N,E,T,W,z,B,te,D,G,H,R,$,J,q,K,Q,X,Y,Z,L,U],styles:[".marks-page[_ngcontent-%COMP%]{--background: #f4f6fb;padding:16px}.marks-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #0ea5a4, #14b8a6);--color: #ffffff;font-weight:600}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:16px;margin-bottom:18px;box-shadow:0 10px 25px #0000000f}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:15px;font-weight:600;margin-bottom:14px;color:#1f2937}.section-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#0ea5a4;font-size:18px}ion-item[_ngcontent-%COMP%]{--background: transparent;border:1px solid #e5e7eb;border-radius:12px;margin-bottom:12px}.student-card[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:14px;border-radius:16px;background:#f9fafb;margin-bottom:12px;box-shadow:0 6px 14px #0000000a}.student-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.roll-circle[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:50%;background:#e0f2fe;color:#075985;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px}.info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#111827}.info[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.student-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.marks-input[_ngcontent-%COMP%]{width:80px;text-align:center;--padding-start: 8px;--padding-end: 8px;font-weight:600}.absent-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:12px;color:#6b7280}.footer-bar[_ngcontent-%COMP%]{--background: #ffffff;padding:10px 14px;box-shadow:0 -6px 20px #00000014}ion-button[_ngcontent-%COMP%]{height:52px;font-size:15px;font-weight:600;border-radius:14px}"]});let o=r;return o})();export{be as EnterMarksPage};
