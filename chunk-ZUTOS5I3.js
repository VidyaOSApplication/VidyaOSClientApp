import{a as f}from"./chunk-HGUJNCJE.js";import{a as F}from"./chunk-FNKDIBDA.js";import{$ as C,$a as W,A as b,B as y,Ca as k,Da as T,F as s,Fa as N,G as M,J as h,K as I,L as x,Ma as P,Oa as B,R as E,S as w,Sa as D,U as j,Ua as V,Va as O,X as v,ab as L,cb as A,eb as U,fb as H,gb as G,l as p,m as g,mb as J,ob as R,pb as $,r as c,s as m,t as _,u as S,vb as q,w as u,wb as z,x as n,y as o}from"./chunk-JP5JOBMG.js";import"./chunk-MYMNFIR5.js";import"./chunk-QUJFQN2Y.js";import"./chunk-SQ2FC6MI.js";import"./chunk-MXQU5NIL.js";import"./chunk-RE5BQNDC.js";import"./chunk-WMOWL56E.js";import"./chunk-VZPOKD32.js";import"./chunk-DE3NY5IG.js";import"./chunk-GVUKRWTT.js";import"./chunk-7FY2OE2O.js";import"./chunk-V5RQBZ6Q.js";import"./chunk-TOLZJHI4.js";import"./chunk-3IV7M6SB.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-O6KNH33T.js";import"./chunk-CKP3SGE2.js";import"./chunk-IMAI2IPK.js";import"./chunk-PAKTAAC6.js";import"./chunk-BBW5KUYG.js";import"./chunk-677QIFDF.js";import"./chunk-G7CBOZIR.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as d}from"./chunk-JHI3MBHO.js";function K(a,r){a&1&&(n(0,"ion-text"),s(1,"Loading..."),o())}function Q(a,r){if(a&1){let l=b();n(0,"ion-card")(1,"ion-card-content")(2,"h2"),s(3),o(),n(4,"ion-item")(5,"ion-label",6),s(6,"Exam Date"),o(),n(7,"ion-input",7),x("ngModelChange",function(e){let t=p(l).$implicit;return I(t.examDate,e)||(t.examDate=e),g(e)}),o()(),n(8,"ion-item")(9,"ion-label",6),s(10,"Max Marks"),o(),n(11,"ion-input",8),x("ngModelChange",function(e){let t=p(l).$implicit;return I(t.maxMarks,e)||(t.maxMarks=e),g(e)}),o()()()()}if(a&2){let l=r.$implicit;c(3),M(l.subjectName),c(4),h("ngModel",l.examDate),c(4),h("ngModel",l.maxMarks)}}function X(a,r){a&1&&(n(0,"ion-text",9),s(1," No subjects found "),o())}var de=(()=>{let r=class r{constructor(i,e,t){this.route=i,this.http=e,this.toast=t,this.subjects=[],this.loading=!0}ngOnInit(){return d(this,null,function*(){this.examId=Number(this.route.snapshot.paramMap.get("examId")),this.classId=Number(this.route.snapshot.paramMap.get("classId"));let i=yield F.get({key:"user_profile"});if(!i.value){this.showError("User session expired");return}this.schoolId=JSON.parse(i.value).schoolId,this.loadSubjects()})}trackById(i,e){return e.subjectId}loadSubjects(){this.http.get(`${f.apiBaseUrl}/Exam/GetSubjectsForSchedule`,{params:{examId:this.examId,classId:this.classId}}).subscribe(i=>{let e=new Date().toISOString().slice(0,10);this.subjects=(i.data||[]).map(t=>({subjectId:t.subjectId,subjectName:t.subjectName,examDate:t.examDate??e,maxMarks:t.maxMarks??100}))})}save(){return d(this,null,function*(){yield this.http.post(`${f.apiBaseUrl}/Exam/ScheduleExam`,{examId:this.examId,classId:this.classId,schoolId:this.schoolId,subjects:this.subjects}).toPromise(),(yield this.toast.create({message:"Schedule saved successfully",color:"success",duration:2e3})).present()})}showError(i){return d(this,null,function*(){yield(yield this.toast.create({message:i,color:"danger",duration:2e3})).present()})}};r.\u0275fac=function(e){return new(e||r)(m(C),m(v),m(q))},r.\u0275cmp=_({type:r,selectors:[["app-schedule-exam"]],decls:12,vars:4,consts:[["color","warning"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["color","danger",4,"ngIf"],["expand","block","color","success",3,"click"],["position","stacked"],["type","date",3,"ngModelChange","ngModel"],["type","number",3,"ngModelChange","ngModel"],["color","danger"]],template:function(e,t){e&1&&(n(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),s(3,"Schedule Exam"),o()()(),n(4,"ion-content",1),S(5,K,2,0,"ion-text",2)(6,Q,12,3,"ion-card",3)(7,X,2,0,"ion-text",4),o(),n(8,"ion-footer")(9,"ion-toolbar")(10,"ion-button",5),y("click",function(){return t.save()}),s(11," Save Schedule "),o()()()),e&2&&(c(5),u("ngIf",t.loading),c(),u("ngForOf",t.subjects)("ngForTrackBy",t.trackById),c(),u("ngIf",!t.loading&&t.subjects.length===0))},dependencies:[j,E,w,N,k,T,z,D,V,O,W,L,A,U,H,G,J,R,$,P,B],encapsulation:2});let a=r;return a})();export{de as ScheduleExamPage};
