import{a as ae}from"./chunk-HGUJNCJE.js";import{a as G}from"./chunk-FNKDIBDA.js";import{A,B as C,C as k,Da as j,Ea as H,F as o,Fa as U,G as b,Ga as q,H as B,J as g,K as p,L as f,Oa as J,Pa as K,R as Y,S as z,Ta as P,U as x,X as V,ab as w,bb as I,db as E,eb as Q,fb as X,gb as Z,hb as $,kb as ee,l as L,lb as te,m as F,mb as ne,nb as ie,pb as v,qb as O,r as a,s as h,t as y,tb as oe,u as S,vb as W,w as c,wb as T,x as t,xb as N,y as n,z as _}from"./chunk-ASIUTVEG.js";import"./chunk-MYMNFIR5.js";import"./chunk-QUJFQN2Y.js";import"./chunk-SQ2FC6MI.js";import"./chunk-MXQU5NIL.js";import"./chunk-RE5BQNDC.js";import"./chunk-WMOWL56E.js";import"./chunk-VZPOKD32.js";import"./chunk-DE3NY5IG.js";import"./chunk-GVUKRWTT.js";import"./chunk-7FY2OE2O.js";import"./chunk-V5RQBZ6Q.js";import"./chunk-TOLZJHI4.js";import"./chunk-3IV7M6SB.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-O6KNH33T.js";import"./chunk-CKP3SGE2.js";import"./chunk-IMAI2IPK.js";import"./chunk-PAKTAAC6.js";import"./chunk-BBW5KUYG.js";import"./chunk-677QIFDF.js";import"./chunk-G7CBOZIR.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as R,b as D,e as M}from"./chunk-JHI3MBHO.js";var re=(()=>{let m=class m{constructor(l,r){this.modalCtrl=l,this.toastCtrl=r}copy(l){return M(this,null,function*(){yield navigator.clipboard.writeText(l),(yield this.toastCtrl.create({message:"Copied to clipboard",duration:1200,position:"top",color:"success"})).present()})}close(){this.modalCtrl.dismiss()}};m.\u0275fac=function(r){return new(r||m)(h(W),h(T))},m.\u0275cmp=y({type:m,selectors:[["app-student-credentials-modal"]],inputs:{admissionNo:"admissionNo",username:"username",password:"password"},decls:39,vars:3,consts:[[1,"success-header"],[1,"success-page"],[1,"content-wrapper"],[1,"success-hero"],[1,"checkmark"],[1,"credentials"],[1,"credential-card"],[1,"label"],[1,"credential-card","highlight"],[1,"warning-box"],[1,"success-footer"],["expand","block",3,"click"]],template:function(r,e){r&1&&(t(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),o(3," \u{1F389} Student Registered "),n()()(),t(4,"ion-content",1)(5,"div",2)(6,"div",3),_(7,"div",4),t(8,"h2"),o(9,"Registration Successful"),n(),t(10,"p"),o(11,"Student credentials have been generated"),n()(),t(12,"div",5)(13,"div",6)(14,"p",7),o(15,"Admission No"),n(),t(16,"h3"),o(17),n()(),t(18,"div",6)(19,"p",7),o(20,"Username"),n(),t(21,"h3"),o(22),n()(),t(23,"div",8)(24,"p",7),o(25,"Temporary Password"),n(),t(26,"h3"),o(27),n()()(),t(28,"div",9)(29,"strong"),o(30,"Security Notice"),n(),t(31,"p"),o(32," Please save these credentials now. They will "),t(33,"b"),o(34,"not be shown again"),n(),o(35,". "),n()()()(),t(36,"ion-footer",10)(37,"ion-button",11),C("click",function(){return e.close()}),o(38," OK, I HAVE SAVED THEM "),n()()),r&2&&(a(17),b(e.admissionNo),a(5),b(e.username),a(5),b(e.password))},dependencies:[N,P,w,I,E,v,O,x],styles:['@charset "UTF-8";.success-page[_ngcontent-%COMP%]{--background: #f4f6fb}.success-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #d1fae5;--color: #14532d;font-weight:700}.content-wrapper[_ngcontent-%COMP%]{padding:12px 16px 8px;display:flex;flex-direction:column;gap:10px}.success-hero[_ngcontent-%COMP%]{text-align:center;margin-top:4px}.checkmark[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#22c55e,#16a34a);margin:0 auto 8px}.success-hero[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:19px;font-weight:700;color:#14532d}.success-hero[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:2px;font-size:13px;color:#166534}.credentials[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.credential-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:12px;text-align:center;box-shadow:0 6px 16px #0000000f}.credential-card.highlight[_ngcontent-%COMP%]{background:#f0fdf4;border:1px solid #bbf7d0}.label[_ngcontent-%COMP%]{font-size:12.5px;color:#6b7280}.credential-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:4px;font-size:15px;font-weight:600;color:#111827;word-break:break-all}.warning-box[_ngcontent-%COMP%]{background:#fff7ed;border-left:4px solid #f59e0b;padding:10px 12px;border-radius:12px;color:#92400e;font-size:13px}.success-footer[_ngcontent-%COMP%]{padding:8px 14px;background:#fff;box-shadow:0 -6px 20px #00000014}.success-footer[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:48px;font-size:14.5px;font-weight:700;border-radius:14px}']});let d=m;return d})();function me(d,m){if(d&1&&(t(0,"ion-select-option",14),o(1),n()),d&2){let u=m.$implicit;c("value",u),a(),B(" ",u," ")}}function ce(d,m){if(d&1&&(t(0,"ion-select-option",14),o(1),n()),d&2){let u=m.$implicit;c("value",u),a(),B(" Class ",u," ")}}function ge(d,m){if(d&1){let u=A();t(0,"ion-item")(1,"ion-label",6),o(2," Stream "),t(3,"ion-text",7),o(4,"*"),n()(),t(5,"ion-select",29),f("ngModelChange",function(r){L(u);let e=k();return p(e.form.streamId,r)||(e.form.streamId=r),F(r)}),t(6,"ion-select-option",14),o(7,"PCM"),n(),t(8,"ion-select-option",14),o(9,"PCB"),n(),t(10,"ion-select-option",14),o(11,"Commerce"),n(),t(12,"ion-select-option",14),o(13,"Arts"),n()()()}if(d&2){let u=k();a(5),g("ngModel",u.form.streamId),a(),c("value",1),a(2),c("value",2),a(2),c("value",3),a(2),c("value",4)}}function pe(d,m){d&1&&(t(0,"ion-text",7),o(1," Please select stream for class 11 / 12 "),n())}function fe(d,m){d&1&&(t(0,"ion-text",7),o(1," Please select admission date "),n())}function ue(d,m){d&1&&(t(0,"ion-text",7),o(1," Enter valid 10-digit mobile number starting with 6\u20139 "),n())}function he(d,m){d&1&&_(0,"ion-spinner",30)}var We=(()=>{let m=class m{constructor(l,r,e,s){this.http=l,this.toastCtrl=r,this.alertCtrl=e,this.modalCtrl=s,this.saving=!1,this.submitted=!1,this.academicYears=[],this.mobileRegex=/^[6-9]\d{9}$/,this.classes=[],this.sections=[{id:1,name:"A"},{id:2,name:"B"},{id:3,name:"C"}],this.form={schoolId:0,classId:null,sectionId:null,streamId:null,firstName:"",lastName:"",gender:"",dob:"",admissionDate:"",academicYear:"",parentPhone:"",fatherName:"",motherName:"",addressLine1:"",city:"",state:"",email:""}}ngOnInit(){return M(this,null,function*(){this.classes=Array.from({length:12},(r,e)=>e+1),this.generateAcademicYears();let l=yield G.get({key:"user_profile"});if(l.value){let r=JSON.parse(l.value);this.form.schoolId=r.schoolId}})}isInvalid(l){return this.submitted&&(!this.form[l]||this.form[l].toString().trim()==="")}isInvalidPhone(){return this.submitted&&!this.mobileRegex.test(this.form.parentPhone)}isInvalidDOB(){if(!this.submitted||!this.form.dob)return!1;let l=new Date,r=new Date(this.form.dob);if(r>l)return!0;let e=l.getFullYear()-r.getFullYear(),s=l.getMonth()-r.getMonth();return(s<0||s===0&&l.getDate()<r.getDate())&&e--,e<3}generateAcademicYears(){let l=new Date,r=l.getFullYear(),s=l.getMonth()+1>=4?r:r-1,i=`${s}-${(s+1).toString().slice(2)}`,le=`${s+1}-${(s+2).toString().slice(2)}`;this.academicYears=[i,le],this.form.academicYear=i}submit(){if(this.submitted=!0,!this.form.schoolId||!this.form.firstName||!this.form.dob||!this.form.classId||!this.form.sectionId||!this.form.academicYear||!this.form.admissionDate||!this.form.parentPhone){this.showToast("Please fill all required fields","danger");return}if(this.isInvalidDOB()){this.showToast("Student must be at least 3 years old and DOB cannot be future","danger");return}if(!this.mobileRegex.test(this.form.parentPhone)){this.showToast("Invalid parent phone number","danger");return}if((this.form.classId===11||this.form.classId===12)&&!this.form.streamId){this.showToast("Please select stream for class 11 / 12","danger");return}this.saving=!0;let l=D(R({},this.form),{dob:new Date(this.form.dob).toISOString(),admissionDate:new Date(this.form.admissionDate).toISOString()});this.http.post(`${ae.apiBaseUrl}/Students/RegisterStudent`,l).subscribe({next:r=>M(this,null,function*(){this.saving=!1,yield(yield this.modalCtrl.create({component:re,componentProps:{admissionNo:r.data.admissionNo,username:r.data.username,password:r.data.tempPassword},backdropDismiss:!1})).present(),this.resetForm()}),error:r=>{this.saving=!1;let e=r?.error?.message||"Student already exists with same name, date of birth and parent mobile number.";this.showToast(e,"danger")}})}resetForm(){this.submitted=!1,this.form=D(R({},this.form),{classId:null,sectionId:null,streamId:null,firstName:"",lastName:"",gender:"",dob:"",admissionDate:"",academicYear:"",parentPhone:"",fatherName:"",motherName:"",addressLine1:"",city:"",state:"",email:""})}onClassChange(){this.form.classId!==11&&this.form.classId!==12&&(this.form.streamId=null)}showToast(l,r){return M(this,null,function*(){yield(yield this.toastCtrl.create({message:l,duration:2200,position:"top",color:r})).present()})}};m.\u0275fac=function(r){return new(r||m)(h(V),h(T),h(oe),h(W))},m.\u0275cmp=y({type:m,selectors:[["app-register-student"]],decls:105,vars:26,consts:[["color","primary"],["size","large"],[1,"form-card"],[1,"section-card"],[1,"section-title"],["name","school-outline"],["position","stacked"],["color","danger"],["interface","popover","mode","md","placeholder","Select academic year",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select class",3,"ngModelChange","ionChange","ngModel"],[4,"ngIf"],["color","danger",4,"ngIf"],["interface","popover","mode","md","placeholder","Select section",3,"ngModelChange","ngModel"],[3,"value"],["name","person-outline"],["placeholder","Enter first name",3,"ngModelChange","ngModel"],["placeholder","Enter last name",3,"ngModelChange","ngModel"],["interface","popover","mode","md","placeholder","Select gender",3,"ngModelChange","ngModel"],["value","Male"],["value","Female"],["type","date",3,"ngModelChange","ngModel"],["name","people-outline"],[3,"ngModelChange","ngModel"],["type","tel","maxlength","10","inputmode","numeric","placeholder","Enter mobile number",3,"ngModelChange","ngModel"],["name","location-outline"],["type","email",3,"ngModelChange","ngModel"],["expand","block","color","success",3,"click","disabled"],["slot","start",4,"ngIf"],["interface","popover","placeholder","Select stream",3,"ngModelChange","ngModel"],["slot","start"]],template:function(r,e){r&1&&(t(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),o(3,"Register Student"),n()()(),t(4,"ion-content")(5,"div",2)(6,"div",3)(7,"h3",4),_(8,"ion-icon",5),o(9," Academic Details "),n(),t(10,"ion-item")(11,"ion-label",6),o(12," Academic Year "),t(13,"ion-text",7),o(14,"*"),n()(),t(15,"ion-select",8),f("ngModelChange",function(i){return p(e.form.academicYear,i)||(e.form.academicYear=i),i}),S(16,me,2,2,"ion-select-option",9),n()(),t(17,"ion-item")(18,"ion-label",6),o(19,"Class *"),n(),t(20,"ion-select",10),f("ngModelChange",function(i){return p(e.form.classId,i)||(e.form.classId=i),i}),C("ionChange",function(){return e.onClassChange()}),S(21,ce,2,2,"ion-select-option",9),n()(),S(22,ge,14,5,"ion-item",11)(23,pe,2,0,"ion-text",12),t(24,"ion-item")(25,"ion-label",6),o(26,"Section *"),n(),t(27,"ion-select",13),f("ngModelChange",function(i){return p(e.form.sectionId,i)||(e.form.sectionId=i),i}),t(28,"ion-select-option",14),o(29,"A"),n(),t(30,"ion-select-option",14),o(31,"B"),n(),t(32,"ion-select-option",14),o(33,"C"),n()()()(),t(34,"div",3)(35,"h3",4),_(36,"ion-icon",15),o(37," Student Details "),n(),t(38,"ion-item")(39,"ion-label",6),o(40,"First Name *"),n(),t(41,"ion-input",16),f("ngModelChange",function(i){return p(e.form.firstName,i)||(e.form.firstName=i),i}),n()(),t(42,"ion-item")(43,"ion-label",6),o(44,"Last Name"),n(),t(45,"ion-input",17),f("ngModelChange",function(i){return p(e.form.lastName,i)||(e.form.lastName=i),i}),n()(),t(46,"ion-item")(47,"ion-label",6),o(48,"Gender *"),n(),t(49,"ion-select",18),f("ngModelChange",function(i){return p(e.form.gender,i)||(e.form.gender=i),i}),t(50,"ion-select-option",19),o(51,"Male"),n(),t(52,"ion-select-option",20),o(53,"Female"),n()()(),t(54,"ion-item")(55,"ion-label",6),o(56,"Date of Birth *"),n(),t(57,"ion-input",21),f("ngModelChange",function(i){return p(e.form.dob,i)||(e.form.dob=i),i}),n()(),t(58,"ion-item")(59,"ion-label",6),o(60,"Admission Date *"),n(),t(61,"ion-input",21),f("ngModelChange",function(i){return p(e.form.admissionDate,i)||(e.form.admissionDate=i),i}),n()(),S(62,fe,2,0,"ion-text",12),n(),t(63,"div",3)(64,"h3",4),_(65,"ion-icon",22),o(66," Parent Details "),n(),t(67,"ion-item")(68,"ion-label",6),o(69,"Father Name"),n(),t(70,"ion-input",23),f("ngModelChange",function(i){return p(e.form.fatherName,i)||(e.form.fatherName=i),i}),n()(),t(71,"ion-item")(72,"ion-label",6),o(73,"Mother Name"),n(),t(74,"ion-input",23),f("ngModelChange",function(i){return p(e.form.motherName,i)||(e.form.motherName=i),i}),n()(),t(75,"ion-item")(76,"ion-label",6),o(77,"Parent Mobile No *"),n(),t(78,"ion-input",24),f("ngModelChange",function(i){return p(e.form.parentPhone,i)||(e.form.parentPhone=i),i}),n()(),S(79,ue,2,0,"ion-text",12),n(),t(80,"div",3)(81,"h3",4),_(82,"ion-icon",25),o(83," Address "),n(),t(84,"ion-item")(85,"ion-label",6),o(86,"Address Line"),n(),t(87,"ion-input",23),f("ngModelChange",function(i){return p(e.form.addressLine1,i)||(e.form.addressLine1=i),i}),n()(),t(88,"ion-item")(89,"ion-label",6),o(90,"City"),n(),t(91,"ion-input",23),f("ngModelChange",function(i){return p(e.form.city,i)||(e.form.city=i),i}),n()(),t(92,"ion-item")(93,"ion-label",6),o(94,"State"),n(),t(95,"ion-input",23),f("ngModelChange",function(i){return p(e.form.state,i)||(e.form.state=i),i}),n()(),t(96,"ion-item")(97,"ion-label",6),o(98,"Email"),n(),t(99,"ion-input",26),f("ngModelChange",function(i){return p(e.form.email,i)||(e.form.email=i),i}),n()()()()(),t(100,"ion-footer")(101,"ion-toolbar")(102,"ion-button",27),C("click",function(){return e.submit()}),S(103,he,1,0,"ion-spinner",28),o(104," Register Student "),n()()()),r&2&&(a(15),g("ngModel",e.form.academicYear),a(),c("ngForOf",e.academicYears),a(4),g("ngModel",e.form.classId),a(),c("ngForOf",e.classes),a(),c("ngIf",e.form.classId===11||e.form.classId===12),a(),c("ngIf",e.submitted&&(e.form.classId===11||e.form.classId===12)&&!e.form.streamId),a(4),g("ngModel",e.form.sectionId),a(),c("value",1),a(2),c("value",2),a(2),c("value",3),a(9),g("ngModel",e.form.firstName),a(4),g("ngModel",e.form.lastName),a(4),g("ngModel",e.form.gender),a(8),g("ngModel",e.form.dob),a(4),g("ngModel",e.form.admissionDate),a(),c("ngIf",e.isInvalid("admissionDate")),a(8),g("ngModel",e.form.fatherName),a(4),g("ngModel",e.form.motherName),a(4),g("ngModel",e.form.parentPhone),a(),c("ngIf",e.isInvalidPhone()),a(8),g("ngModel",e.form.addressLine1),a(4),g("ngModel",e.form.city),a(4),g("ngModel",e.form.state),a(4),g("ngModel",e.form.email),a(3),c("disabled",e.saving),a(),c("ngIf",e.saving))},dependencies:[x,Y,z,q,j,U,H,N,P,w,I,E,Q,X,Z,$,ee,te,ne,ie,v,O,J,K],styles:["ion-content[_ngcontent-%COMP%]{--background: #f4f6fb}.form-card[_ngcontent-%COMP%]{padding:16px 16px 100px}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:16px;margin-bottom:18px;box-shadow:0 10px 25px #0000000f}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0 0 14px;font-size:15px;font-weight:600;color:#2c2c2c}.section-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--ion-color-primary)}ion-item[_ngcontent-%COMP%]{--background: transparent;--highlight-height: 0;--min-height: 52px;border:1px solid #e4e7ec;border-radius:12px;margin-bottom:12px}ion-item.item-has-focus[_ngcontent-%COMP%]{border-color:var(--ion-color-primary)}ion-input[_ngcontent-%COMP%], ion-select[_ngcontent-%COMP%]{font-size:14px}ion-text[color=danger][_ngcontent-%COMP%]{font-size:12px;margin-left:6px;margin-top:4px;display:block}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #ffffff;box-shadow:0 -6px 20px #00000014;padding:10px 14px}ion-button[_ngcontent-%COMP%]{height:52px;font-size:15px;font-weight:600;border-radius:14px}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-item[_ngcontent-%COMP%]{--disabled-opacity: 1;opacity:1!important}ion-select[_ngcontent-%COMP%]{--color: #111827;--placeholder-color: #6b7280;--placeholder-opacity: 1;opacity:1!important}ion-select[_ngcontent-%COMP%]::part(text){color:#111827!important;opacity:1!important;font-weight:500}ion-select[_ngcontent-%COMP%]::part(icon){color:#374151!important;opacity:1!important}ion-item.item-has-value[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(text){color:#111827!important}ion-label[_ngcontent-%COMP%]{color:#111827!important;opacity:1!important}"]});let d=m;return d})();export{We as RegisterStudentPage};
