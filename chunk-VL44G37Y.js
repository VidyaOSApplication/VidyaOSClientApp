import{a as Z}from"./chunk-HGUJNCJE.js";import{a as P}from"./chunk-FNKDIBDA.js";import{$a as H,A as I,B as g,C as f,Ca as A,Da as E,F as l,Fa as k,H as C,J as M,K as v,L as w,Oa as D,R as x,S as y,Sa as F,U as T,Ua as $,Va as O,Wa as V,X as N,Ya as B,cb as L,db as W,eb as z,fb as G,gb as J,hb as U,l as j,lb as q,m as _,ob as K,pb as Q,r,s as u,sb as R,t as S,u as p,vb as X,w as c,wb as Y,x as a,y as o,z as b}from"./chunk-JP5JOBMG.js";import"./chunk-MYMNFIR5.js";import"./chunk-QUJFQN2Y.js";import"./chunk-SQ2FC6MI.js";import"./chunk-MXQU5NIL.js";import"./chunk-RE5BQNDC.js";import"./chunk-WMOWL56E.js";import"./chunk-VZPOKD32.js";import"./chunk-DE3NY5IG.js";import"./chunk-GVUKRWTT.js";import"./chunk-7FY2OE2O.js";import"./chunk-V5RQBZ6Q.js";import"./chunk-TOLZJHI4.js";import"./chunk-3IV7M6SB.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-O6KNH33T.js";import"./chunk-CKP3SGE2.js";import"./chunk-IMAI2IPK.js";import"./chunk-PAKTAAC6.js";import"./chunk-BBW5KUYG.js";import"./chunk-677QIFDF.js";import"./chunk-G7CBOZIR.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as m}from"./chunk-JHI3MBHO.js";function te(n,s){n&1&&b(0,"ion-spinner",8)}function ie(n,s){if(n&1){let d=I();a(0,"ion-item",10)(1,"ion-label"),l(2),o(),a(3,"ion-button",11),g("click",function(){let e=j(d).$implicit,i=f(2);return _(i.confirmDelete(e))}),b(4,"ion-icon",12),o()()}if(n&2){let d=s.$implicit;r(2),C(" ",d.subjectName," ")}}function ne(n,s){if(n&1&&(a(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),l(3,"Existing Subjects"),o()(),a(4,"ion-card-content")(5,"ion-list"),p(6,ie,5,1,"ion-item",9),o()()()),n&2){let d=f();r(6),c("ngForOf",d.subjects)}}function oe(n,s){n&1&&(a(0,"p",13),l(1," No subjects added yet "),o())}var be=(()=>{let s=class s{constructor(t,e,i){this.http=t,this.toastCtrl=e,this.alertCtrl=i,this.subjectName="",this.subjects=[],this.saving=!1,this.loading=!1,this.api=`${Z.apiBaseUrl}/School`}ngOnInit(){return m(this,null,function*(){let t=yield P.get({key:"user_profile"});t.value&&(this.schoolId=JSON.parse(t.value).schoolId,this.loadSubjects())})}loadSubjects(){this.loading=!0,this.http.get(`${this.api}/GetMasterSubjects`,{params:{schoolId:this.schoolId}}).subscribe({next:t=>{this.subjects=t.data||[],this.loading=!1},error:()=>{this.loading=!1,this.showToast("Failed to load subjects","danger")}})}addSubject(){if(!this.subjectName)return;this.saving=!0;let t={schoolId:this.schoolId,subjectName:this.subjectName};this.http.post(`${this.api}/AddMasterSubject`,t).subscribe({next:e=>{this.saving=!1,this.subjectName="",this.showToast(e.message||"Subject added","success"),this.loadSubjects()},error:e=>{this.saving=!1,this.showToast(e.error?.message||"Failed to add subject","danger")}})}confirmDelete(t){return m(this,null,function*(){yield(yield this.alertCtrl.create({header:"Delete Subject",message:`Delete "${t.subjectName}"?`,buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"destructive",handler:()=>this.deleteSubject(t.masterSubjectId)}]})).present()})}deleteSubject(t){this.http.delete(`${this.api}/DeleteMasterSubject?id=${t}`).subscribe({next:e=>{this.showToast(e.message||"Subject deleted","success"),this.loadSubjects()},error:e=>{this.showToast(e.error?.message||"Cannot delete subject","danger")}})}showToast(t,e){return m(this,null,function*(){yield(yield this.toastCtrl.create({message:t,duration:2e3,position:"bottom",color:e})).present()})}};s.\u0275fac=function(e){return new(e||s)(u(N),u(X),u(R))},s.\u0275cmp=S({type:s,selectors:[["app-admin-master-subjects"]],decls:19,vars:5,consts:[["color","primary"],[1,"ion-padding"],["position","stacked"],["placeholder","e.g. Mathematics",3,"ngModelChange","ngModel"],["expand","block","color","success",3,"click","disabled"],["slot","start",4,"ngIf"],[4,"ngIf"],["class","ion-text-center ion-margin-top",4,"ngIf"],["slot","start"],["lines","full","class","subject-row",4,"ngFor","ngForOf"],["lines","full",1,"subject-row"],["slot","end","size","small","color","danger","fill","solid",3,"click"],["name","trash-outline"],[1,"ion-text-center","ion-margin-top"]],template:function(e,i){e&1&&(a(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),l(3,"Master Subjects"),o()()(),a(4,"ion-content",1)(5,"ion-card")(6,"ion-card-header")(7,"ion-card-title"),l(8,"Add Subject"),o()(),a(9,"ion-card-content")(10,"ion-item")(11,"ion-label",2),l(12,"Subject Name *"),o(),a(13,"ion-input",3),w("ngModelChange",function(h){return v(i.subjectName,h)||(i.subjectName=h),h}),o()(),a(14,"ion-button",4),g("click",function(){return i.addSubject()}),p(15,te,1,0,"ion-spinner",5),l(16," Add Subject "),o()()(),p(17,ne,7,1,"ion-card",6)(18,oe,2,0,"p",7),o()),e&2&&(r(13),M("ngModel",i.subjectName),r(),c("disabled",i.saving||!i.subjectName),r(),c("ngIf",i.saving),r(2),c("ngIf",i.subjects.length),r(),c("ngIf",!i.subjects.length))},dependencies:[Y,F,$,O,V,B,H,L,W,z,G,J,U,q,K,Q,D,T,x,y,k,A,E],encapsulation:2});let n=s;return n})();export{be as AdminMasterSubjectsPage};
