import{a as ae}from"./chunk-HGUJNCJE.js";import{a as B}from"./chunk-FNKDIBDA.js";import{$a as U,A as S,B as O,C as u,Ca as W,Da as z,F as n,Fa as N,G as p,H as _,J as h,K as x,L as y,N as E,Na as L,Oa as D,R as k,Ra as j,S as T,Sa as H,U as A,X as V,_ as F,_a as R,bb as G,cb as J,db as q,eb as K,fb as Q,gb as X,ib as Y,jb as Z,kb as $,l as M,m as w,ob as ee,p as P,pb as te,r as i,s as C,t as v,tb as ne,u as g,vb as ie,w as d,wb as oe,x as t,y as e,z as I}from"./chunk-JP5JOBMG.js";import"./chunk-MYMNFIR5.js";import"./chunk-QUJFQN2Y.js";import"./chunk-SQ2FC6MI.js";import"./chunk-MXQU5NIL.js";import"./chunk-RE5BQNDC.js";import"./chunk-WMOWL56E.js";import"./chunk-VZPOKD32.js";import"./chunk-DE3NY5IG.js";import"./chunk-GVUKRWTT.js";import"./chunk-7FY2OE2O.js";import"./chunk-V5RQBZ6Q.js";import"./chunk-TOLZJHI4.js";import"./chunk-3IV7M6SB.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-O6KNH33T.js";import"./chunk-CKP3SGE2.js";import"./chunk-IMAI2IPK.js";import"./chunk-PAKTAAC6.js";import"./chunk-BBW5KUYG.js";import"./chunk-677QIFDF.js";import"./chunk-G7CBOZIR.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as f}from"./chunk-JHI3MBHO.js";var re=()=>[1,2,3,4,5,6,7,8,9,10,11,12];function se(a,l){if(a&1&&(t(0,"ion-select-option",11),n(1),e()),a&2){let o=l.$implicit;d("value",o),i(),_(" Class ",o," ")}}function ce(a,l){if(a&1&&(t(0,"ion-select-option",11),n(1),e()),a&2){let o=l.$implicit;d("value",o.id),i(),_(" ",o.name," ")}}function le(a,l){if(a&1){let o=S();t(0,"ion-item")(1,"ion-label",5),n(2,"Stream"),e(),t(3,"ion-select",16),y("ngModelChange",function(c){M(o);let r=u();return x(r.streamId,c)||(r.streamId=c),w(c)}),g(4,ce,2,2,"ion-select-option",9),e()()}if(a&2){let o=u();i(3),h("ngModel",o.streamId),i(),d("ngForOf",o.streams)}}function de(a,l){if(a&1&&(t(0,"div",17)(1,"h3",3),I(2,"ion-icon",18),n(3," Summary "),e(),t(4,"div",19)(5,"div",20)(6,"span"),n(7,"Total"),e(),t(8,"strong"),n(9),e()(),t(10,"div",21)(11,"span"),n(12,"Present"),e(),t(13,"strong"),n(14),e()(),t(15,"div",22)(16,"span"),n(17,"Absent"),e(),t(18,"strong"),n(19),e()(),t(20,"div",23)(21,"span"),n(22,"Leave"),e(),t(23,"strong"),n(24),e()(),t(25,"div",24)(26,"span"),n(27,"Not Marked"),e(),t(28,"strong"),n(29),e()()()()),a&2){let o=u();i(9),p(o.summary.total),i(5),p(o.summary.present),i(5),p(o.summary.absent),i(5),p(o.summary.leave),i(5),p(o.summary.notMarked)}}function me(a,l){if(a&1&&(t(0,"div",27)(1,"div",28)(2,"div",29),n(3),e(),t(4,"div",30)(5,"div",31),n(6),e(),t(7,"div",32),n(8,"Roll No"),e()()(),t(9,"ion-badge",33),n(10),e()()),a&2){let o=l.$implicit,s=u(2);i(3),_(" ",o.rollNo," "),i(3),p(o.fullName),i(3),d("color",s.getStatusColor(o.status)),i(),_(" ",o.status," ")}}function pe(a,l){if(a&1&&(t(0,"div",2)(1,"h3",3),I(2,"ion-icon",25),n(3," Student Attendance "),e(),g(4,me,11,4,"div",26),e()),a&2){let o=u();i(4),d("ngForOf",o.students)}}var we=(()=>{let l=class l{constructor(s,c,r){this.http=s,this.loadingCtrl=c,this.toastCtrl=r,this.date="",this.today="",this.students=[],this.streamId=null,this.streams=[{id:1,name:"PCM"},{id:2,name:"PCB"},{id:3,name:"Commerce"},{id:4,name:"Arts"}]}ngOnInit(){return f(this,null,function*(){let s=new Date(new Date().getTime()-new Date().getTimezoneOffset()*6e4);this.today=s.toISOString().split("T")[0],this.date=this.today,yield this.loadSchoolId()})}ngOnChanges(){this.classId!==11&&this.classId!==12&&(this.streamId=null)}loadSchoolId(){return f(this,null,function*(){let{value:s}=yield B.get({key:"user_profile"});if(!s){this.showToast("User profile not found. Please login again.");return}let c=JSON.parse(s);this.schoolId=c.schoolId})}viewAttendance(){return f(this,null,function*(){if(!this.date||!this.classId||!this.sectionId){this.showToast("Please select date, class and section");return}if(!this.schoolId){this.showToast("School not identified");return}if((this.classId===11||this.classId===12)&&!this.streamId){this.showToast("Please select stream for class 11/12");return}let s=yield this.loadingCtrl.create({message:"Loading attendance..."});yield s.present(),this.http.get(`${ae.apiBaseUrl}/School/ViewAttendance`,{params:{schoolId:this.schoolId,classId:this.classId,sectionId:this.sectionId,date:this.date,streamId:this.classId===11||this.classId===12?this.streamId:""}}).subscribe({next:c=>{this.summary=c.summary,this.students=c.students||[],s.dismiss()},error:()=>{s.dismiss(),this.showToast("Failed to load attendance")}})})}getStatusColor(s){switch(s){case"Present":return"success";case"Absent":return"danger";case"Leave":return"warning";default:return"medium"}}showToast(s){return f(this,null,function*(){yield(yield this.toastCtrl.create({message:s,duration:2e3,position:"bottom",color:"dark"})).present()})}};l.\u0275fac=function(c){return new(c||l)(C(V),C(ne),C(ie))},l.\u0275cmp=v({type:l,selectors:[["app-view-attendance"]],features:[P],decls:37,vars:12,consts:[[1,"attendance-header"],[1,"attendance-page"],[1,"section-card"],[1,"section-title"],["name","calendar-outline"],["position","stacked"],["type","date",3,"ngModelChange","ngModel","max"],["size","6"],["placeholder","Select Class",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select Section",3,"ngModelChange","ngModel"],[3,"value"],[4,"ngIf"],["expand","block",1,"primary-btn",3,"click"],["class","summary-card",4,"ngIf"],["class","section-card",4,"ngIf"],["placeholder","Select Stream",3,"ngModelChange","ngModel"],[1,"summary-card"],["name","stats-chart-outline"],[1,"summary-grid"],[1,"summary-item","primary"],[1,"summary-item","success"],[1,"summary-item","danger"],[1,"summary-item","warning"],[1,"summary-item","medium"],["name","people-outline"],["class","student-card",4,"ngFor","ngForOf"],[1,"student-card"],[1,"left"],[1,"roll-circle"],[1,"info"],[1,"name"],[1,"sub"],[1,"status-badge",3,"color"]],template:function(c,r){c&1&&(t(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),n(3,"View Attendance"),e()()(),t(4,"ion-content",1)(5,"div",2)(6,"h3",3),I(7,"ion-icon",4),n(8," Attendance Filters "),e(),t(9,"ion-item")(10,"ion-label",5),n(11,"Date"),e(),t(12,"ion-input",6),y("ngModelChange",function(m){return x(r.date,m)||(r.date=m),m}),e()(),t(13,"ion-grid")(14,"ion-row")(15,"ion-col",7)(16,"ion-item")(17,"ion-label",5),n(18,"Class"),e(),t(19,"ion-select",8),y("ngModelChange",function(m){return x(r.classId,m)||(r.classId=m),m}),g(20,se,2,2,"ion-select-option",9),e()()(),t(21,"ion-col",7)(22,"ion-item")(23,"ion-label",5),n(24,"Section"),e(),t(25,"ion-select",10),y("ngModelChange",function(m){return x(r.sectionId,m)||(r.sectionId=m),m}),t(26,"ion-select-option",11),n(27,"A"),e(),t(28,"ion-select-option",11),n(29,"B"),e(),t(30,"ion-select-option",11),n(31,"C"),e()()()()()(),g(32,le,5,2,"ion-item",12),t(33,"ion-button",13),O("click",function(){return r.viewAttendance()}),n(34," View Attendance "),e()(),g(35,de,30,5,"div",14)(36,pe,5,1,"div",15),e()),c&2&&(i(12),h("ngModel",r.date),d("max",r.today),i(7),h("ngModel",r.classId),i(),d("ngForOf",E(11,re)),i(5),h("ngModel",r.sectionId),i(),d("value",1),i(2),d("value",2),i(2),d("value",3),i(2),d("ngIf",r.classId===11||r.classId===12),i(3),d("ngIf",r.summary),i(),d("ngIf",r.students.length))},dependencies:[oe,j,H,R,U,G,J,q,K,Q,X,Y,Z,$,ee,te,L,D,A,k,T,N,W,z,F],styles:[".attendance-page[_ngcontent-%COMP%]{--background: #f4f6fb;padding:16px}.attendance-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #e0f2fe;--color: #075985;font-weight:700}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:16px;margin-bottom:18px;box-shadow:0 10px 25px #0000000f}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:15px;font-weight:600;margin-bottom:14px;color:#1f2937}.section-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}ion-item[_ngcontent-%COMP%]{--background: transparent;border:1px solid #e5e7eb;border-radius:12px;margin-bottom:12px}.primary-btn[_ngcontent-%COMP%]{height:48px;font-weight:600;margin-top:6px}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:16px;margin-bottom:18px;box-shadow:0 10px 25px #0000000f}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(110px,1fr));gap:10px}.summary-item[_ngcontent-%COMP%]{border-radius:14px;padding:12px;text-align:center}.summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;color:inherit}.summary-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:18px;font-weight:700}.summary-item.primary[_ngcontent-%COMP%]{background:#e0f2fe;color:#075985}.summary-item.success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.summary-item.danger[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.summary-item.warning[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.summary-item.medium[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.student-card[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-radius:16px;background:#f9fafb;margin-bottom:12px;box-shadow:0 6px 14px #0000000a}.student-card[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.roll-circle[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:50%;background:#e0f2fe;color:#075985;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px}.student-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#111827}.student-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.status-badge[_ngcontent-%COMP%]{font-size:13px;padding:6px 14px;border-radius:999px;font-weight:600}ion-badge[color=success][_ngcontent-%COMP%]{--background: #22c55e;color:#fff}ion-badge[color=danger][_ngcontent-%COMP%]{--background: #ef4444;color:#fff}ion-badge[color=warning][_ngcontent-%COMP%]{--background: #f59e0b;color:#fff}ion-select[_ngcontent-%COMP%]{--color: #111827;--placeholder-color: #6b7280;--placeholder-opacity: 1;opacity:1!important}ion-select[_ngcontent-%COMP%]::part(text){color:#111827!important;opacity:1!important;font-weight:500}ion-item.item-has-value[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(text){color:#111827!important;opacity:1!important}ion-select[_ngcontent-%COMP%]::part(icon){color:#374151!important;opacity:1!important}ion-checkbox[_ngcontent-%COMP%]{--size: 22px;--border-width: 2px;--border-radius: 6px;--border-color: #9ca3af;--background: #ffffff;--checkmark-color: #ffffff;--background-checked: #0ea5a4;--border-color-checked: #0ea5a4}ion-item.item-interactive[_ngcontent-%COMP%]{opacity:1!important}ion-item.item-has-value[_ngcontent-%COMP%]{opacity:1!important}ion-item.item-has-focus[_ngcontent-%COMP%]{opacity:1!important}"]});let a=l;return a})();export{we as ViewAttendancePage};
