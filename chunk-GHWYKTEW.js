import{a as m}from"./chunk-HGUJNCJE.js";import{a as e}from"./chunk-FNKDIBDA.js";import{d as c,g as n,h as u,i as f,ka as y}from"./chunk-A35WYOVZ.js";import{a as l,b as p,e as r}from"./chunk-JHI3MBHO.js";var h=m.apiBaseUrl;var P=(()=>{let a=class a{constructor(t){this.http=t,this.apiUrl=h}login(t,i){return this.http.post(`${this.apiUrl}/Auth/Login`,{username:t,password:i}).pipe(n(o=>r(this,null,function*(){o.success&&(yield this.saveAuthData(o.data))})),c(o=>o.data.role))}getMyProfile(t){return this.http.get(`${this.apiUrl}/Common/Me`).pipe(n(i=>r(this,null,function*(){let o=p(l({},i),{username:t});yield e.set({key:"user_profile",value:JSON.stringify(o)})})))}saveAuthData(t){return r(this,null,function*(){let i=Date.now()+t.expiresIn*1e3;yield e.set({key:"jwt_token",value:t.token}),yield e.set({key:"user_role",value:t.role}),yield e.set({key:"token_expiry",value:i.toString()})})}getRole(){return r(this,null,function*(){return(yield e.get({key:"user_role"})).value})}getStoredProfile(){return r(this,null,function*(){let t=yield e.get({key:"user_profile"});return t.value?JSON.parse(t.value):null})}getToken(){return r(this,null,function*(){return(yield e.get({key:"jwt_token"})).value})}logout(){return r(this,null,function*(){yield e.clear()})}};a.\u0275fac=function(i){return new(i||a)(f(y))},a.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"});let s=a;return s})();export{h as a,P as b};
