import{a as F}from"./chunk-HGUJNCJE.js";import{a as B}from"./chunk-FNKDIBDA.js";import{$a as U,A as C,B as b,C as u,Ca as N,Da as k,F as l,Fa as W,H as M,I as P,J as g,K as h,L as _,Ma as V,Na as z,Oa as L,R as A,S as O,Sa as j,U as E,X as T,cb as D,db as H,eb as q,fb as G,gb as J,jb as K,kb as Q,l as y,lb as R,m as I,ob as X,pb as Y,r as o,s as v,t as w,u as f,vb as Z,w as c,wb as $,x as t,y as n,z as p}from"./chunk-JP5JOBMG.js";import"./chunk-MYMNFIR5.js";import"./chunk-QUJFQN2Y.js";import"./chunk-SQ2FC6MI.js";import"./chunk-MXQU5NIL.js";import"./chunk-RE5BQNDC.js";import"./chunk-WMOWL56E.js";import"./chunk-VZPOKD32.js";import"./chunk-DE3NY5IG.js";import"./chunk-GVUKRWTT.js";import"./chunk-7FY2OE2O.js";import"./chunk-V5RQBZ6Q.js";import"./chunk-TOLZJHI4.js";import"./chunk-3IV7M6SB.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-O6KNH33T.js";import"./chunk-CKP3SGE2.js";import"./chunk-IMAI2IPK.js";import"./chunk-PAKTAAC6.js";import"./chunk-BBW5KUYG.js";import"./chunk-677QIFDF.js";import"./chunk-G7CBOZIR.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{e as S}from"./chunk-JHI3MBHO.js";function ee(r,m){if(r&1&&(t(0,"ion-select-option",14),l(1),n()),r&2){let s=m.$implicit;c("value",s),o(),M(" Class ",s," ")}}function te(r,m){if(r&1){let s=C();t(0,"ion-item")(1,"ion-label",5),l(2,"Stream *"),n(),t(3,"ion-select",15),_("ngModelChange",function(a){y(s);let e=u();return h(e.form.streamId,a)||(e.form.streamId=a),I(a)}),t(4,"ion-select-option",14),l(5,"PCM"),n(),t(6,"ion-select-option",14),l(7,"PCB"),n(),t(8,"ion-select-option",14),l(9,"Commerce"),n(),t(10,"ion-select-option",14),l(11,"Arts"),n()()()}if(r&2){let s=u();o(3),g("ngModel",s.form.streamId),o(),c("value",1),o(2),c("value",2),o(2),c("value",3),o(2),c("value",4)}}function ne(r,m){r&1&&p(0,"ion-spinner",16)}function ie(r,m){if(r&1){let s=C();t(0,"div",20)(1,"div",21)(2,"div",22),l(3),n(),t(4,"div",23),l(5),n()(),t(6,"ion-button",24),b("click",function(){let a=y(s).$implicit,e=u(2);return I(e.editFee(a))}),p(7,"ion-icon",25),n()()}if(r&2){let s=m.$implicit;o(3),M(" Class ",s.className," "),o(2),P(" ",s.feeName," \u2022 \u20B9",s.monthlyAmount," ")}}function oe(r,m){if(r&1&&(t(0,"div",2)(1,"h3",3),p(2,"ion-icon",17),l(3," Existing Fee Structures "),n(),t(4,"div",18),f(5,ie,8,3,"div",19),n()()),r&2){let s=u();o(5),c("ngForOf",s.feeStructures)}}var ge=(()=>{let m=class m{constructor(i,a){this.http=i,this.toastCtrl=a,this.loading=!1,this.saving=!1,this.schoolId=0,this.classes=[],this.feeStructures=[],this.form={classId:null,streamId:null,feeName:"",monthlyAmount:null}}ngOnInit(){return S(this,null,function*(){this.classes=Array.from({length:12},(a,e)=>e+1);let i=yield B.get({key:"user_profile"});i.value&&(this.schoolId=JSON.parse(i.value).schoolId,this.loadFeeStructures())})}loadFeeStructures(){this.loading=!0,this.http.get(`${F.apiBaseUrl}/School/GetFeeStructures?schoolId=${this.schoolId}`).subscribe({next:i=>{this.feeStructures=i.data||[],this.loading=!1},error:()=>{this.loading=!1}})}saveFee(){if((this.form.classId===11||this.form.classId===12)&&!this.form.streamId){this.showToast("Please select stream for class 11 / 12","danger");return}if(!this.form.classId||!this.form.feeName||!this.form.monthlyAmount){this.showToast("Please fill all required fields","danger");return}this.saving=!0;let i={schoolId:this.schoolId,classId:this.form.classId,streamId:this.form.streamId,feeName:this.form.feeName,monthlyAmount:this.form.monthlyAmount};this.http.post(`${F.apiBaseUrl}/School/SaveFeeStructure`,i).subscribe({next:a=>{this.saving=!1,this.showToast(a.message||"Fee saved successfully","success"),this.resetForm(),this.loadFeeStructures()},error:()=>{this.saving=!1}})}editFee(i){this.form.classId=i.classId,this.form.streamId=i.streamId??null,this.form.feeName=i.feeName,this.form.monthlyAmount=i.monthlyAmount}resetForm(){this.form={classId:null,streamId:null,feeName:"",monthlyAmount:null}}showToast(i,a){return S(this,null,function*(){yield(yield this.toastCtrl.create({message:i,duration:2e3,position:"top",color:a})).present()})}};m.\u0275fac=function(a){return new(a||m)(v(T),v(Z))},m.\u0275cmp=w({type:m,selectors:[["app-admin-fee-structure"]],decls:27,vars:8,consts:[[1,"fee-header"],[1,"fee-page"],[1,"section-card"],[1,"section-title"],["name","add-circle-outline"],["position","stacked"],["placeholder","Select class",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["placeholder","e.g. Monthly Tuition Fee",3,"ngModelChange","ngModel"],["type","number","placeholder","Enter amount",3,"ngModelChange","ngModel"],["expand","block","color","success",1,"primary-btn",3,"click","disabled"],["slot","start",4,"ngIf"],["class","section-card",4,"ngIf"],[3,"value"],["placeholder","Select stream",3,"ngModelChange","ngModel"],["slot","start"],["name","wallet-outline"],[1,"fee-list"],["class","fee-row",4,"ngFor","ngForOf"],[1,"fee-row"],[1,"fee-info"],[1,"class-name"],[1,"fee-meta"],["fill","clear","size","small",3,"click"],["name","create-outline"]],template:function(a,e){a&1&&(t(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),l(3,"Fee Structure"),n()()(),t(4,"ion-content",1)(5,"div",2)(6,"h3",3),p(7,"ion-icon",4),l(8," Add / Update Fee "),n(),t(9,"ion-item")(10,"ion-label",5),l(11,"Class *"),n(),t(12,"ion-select",6),_("ngModelChange",function(d){return h(e.form.classId,d)||(e.form.classId=d),d}),f(13,ee,2,2,"ion-select-option",7),n()(),f(14,te,12,5,"ion-item",8),t(15,"ion-item")(16,"ion-label",5),l(17,"Fee Name *"),n(),t(18,"ion-input",9),_("ngModelChange",function(d){return h(e.form.feeName,d)||(e.form.feeName=d),d}),n()(),t(19,"ion-item")(20,"ion-label",5),l(21,"Monthly Amount *"),n(),t(22,"ion-input",10),_("ngModelChange",function(d){return h(e.form.monthlyAmount,d)||(e.form.monthlyAmount=d),d}),n()(),t(23,"ion-button",11),b("click",function(){return e.saveFee()}),f(24,ne,1,0,"ion-spinner",12),l(25," Save Fee Structure "),n()(),f(26,oe,6,1,"div",13),n()),a&2&&(o(12),g("ngModel",e.form.classId),o(),c("ngForOf",e.classes),o(),c("ngIf",e.form.classId===11||e.form.classId===12),o(4),g("ngModel",e.form.feeName),o(4),g("ngModel",e.form.monthlyAmount),o(),c("disabled",e.saving),o(),c("ngIf",e.saving),o(2),c("ngIf",e.feeStructures.length))},dependencies:[E,A,O,$,j,U,D,H,q,G,J,K,Q,R,X,Y,V,z,L,W,N,k],styles:[".fee-page[_ngcontent-%COMP%]{--background: #f4f6fb;padding:16px}.fee-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #2563eb, #3b82f6);--color: #ffffff;box-shadow:0 6px 20px #00000040}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:16px;margin-bottom:18px;box-shadow:0 10px 25px #0000000f}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:14px;font-size:15px;font-weight:600;color:#1f2937}.section-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--ion-color-primary)}ion-item[_ngcontent-%COMP%]{--background: transparent;border:1px solid #e5e7eb;border-radius:12px;margin-bottom:12px}ion-item.item-has-focus[_ngcontent-%COMP%]{border-color:var(--ion-color-primary)}ion-input[_ngcontent-%COMP%], ion-select[_ngcontent-%COMP%]{font-size:14px}.primary-btn[_ngcontent-%COMP%]{height:50px;margin-top:10px;font-size:15px;font-weight:600;border-radius:14px}.fee-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.fee-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-radius:14px;background:#f9fafb;box-shadow:0 6px 14px #0000000a}.fee-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.class-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#111827}.fee-meta[_ngcontent-%COMP%]{font-size:13px;color:#6b7280}"]});let r=m;return r})();export{ge as AdminFeeStructurePage};
