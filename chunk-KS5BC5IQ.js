import{a as U}from"./chunk-HGUJNCJE.js";import{a as T}from"./chunk-FNKDIBDA.js";import{A as d,Bb as B,C as p,Cb as R,D as o,Db as N,E as t,Eb as j,F as I,Fb as q,J as v,Kb as H,Lb as J,Ra as P,S as m,Sa as S,Ua as w,W as f,X as c,Y as g,db as O,fa as M,gb as L,ha as C,ka as D,pb as E,qb as A,sb as k,u as l,ub as W,vb as F,w as _,wb as z,y}from"./chunk-A35WYOVZ.js";import"./chunk-MYMNFIR5.js";import"./chunk-QUJFQN2Y.js";import"./chunk-SQ2FC6MI.js";import"./chunk-MXQU5NIL.js";import"./chunk-RE5BQNDC.js";import"./chunk-WMOWL56E.js";import"./chunk-VZPOKD32.js";import"./chunk-DE3NY5IG.js";import"./chunk-GVUKRWTT.js";import"./chunk-7FY2OE2O.js";import"./chunk-V5RQBZ6Q.js";import"./chunk-TOLZJHI4.js";import"./chunk-3IV7M6SB.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-O6KNH33T.js";import"./chunk-CKP3SGE2.js";import"./chunk-IMAI2IPK.js";import"./chunk-IGVXFY24.js";import"./chunk-5TIAO6TV.js";import"./chunk-BANGDX2W.js";import"./chunk-FZQDFHAZ.js";import"./chunk-CLDSZD2A.js";import"./chunk-M2X7KQLB.js";import"./chunk-XTVTS2NW.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as x,b,e as h}from"./chunk-JHI3MBHO.js";function V(n,a){n&1&&(o(0,"ion-text",8),m(1," Please select from date "),t())}function G(n,a){n&1&&(o(0,"ion-text",8),m(1," Please select to date "),t())}function K(n,a){n&1&&(o(0,"ion-text",8),m(1," From date cannot be after To date "),t())}function Q(n,a){n&1&&(o(0,"ion-text",8),m(1," Reason is required "),t())}function X(n,a){n&1&&I(0,"ion-spinner",9)}var se=(()=>{let a=class a{constructor(i,r){this.http=i,this.toastCtrl=r,this.submitting=!1,this.submitted=!1,this.form={schoolId:0,studentId:0,fromDate:"",toDate:"",reason:""}}ngOnInit(){return h(this,null,function*(){let i=yield T.get({key:"user_profile"});if(i.value){let r=JSON.parse(i.value);this.form.schoolId=r.schoolId,this.form.studentId=r.userId}})}isInvalid(i){return this.submitted&&!this.form[i]}isInvalidDateRange(){return!this.form.fromDate||!this.form.toDate?!1:new Date(this.form.fromDate)>new Date(this.form.toDate)}submit(){if(this.submitted=!0,!this.form.schoolId||!this.form.studentId||!this.form.fromDate||!this.form.toDate||!this.form.reason){this.showToast("Please fill all required fields","danger");return}if(this.isInvalidDateRange()){this.showToast("From date cannot be after To date","danger");return}this.submitting=!0;let i=b(x({},this.form),{fromDate:new Date(this.form.fromDate).toISOString(),toDate:new Date(this.form.toDate).toISOString()});this.http.post(`${U.apiBaseUrl}/School/ApplyLeave`,i).subscribe({next:()=>{this.submitting=!1,this.showToast("Leave applied successfully","success"),this.resetForm()},error:()=>{this.submitting=!1}})}resetForm(){this.submitted=!1,this.form.fromDate="",this.form.toDate="",this.form.reason=""}showToast(i,r){return h(this,null,function*(){yield(yield this.toastCtrl.create({message:i,duration:2e3,position:"top",color:r})).present()})}};a.\u0275fac=function(r){return new(r||a)(_(D),_(H))},a.\u0275cmp=y({type:a,selectors:[["app-student-apply-leave"]],decls:27,vars:9,consts:[["color","primary"],[1,"form-card"],["position","stacked"],["type","date",3,"ngModelChange","ngModel"],["color","danger",4,"ngIf"],["rows","4","placeholder","Enter reason",3,"ngModelChange","ngModel"],["expand","block","color","success",3,"click","disabled"],["slot","start",4,"ngIf"],["color","danger"],["slot","start"]],template:function(r,e){r&1&&(o(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),m(3,"Apply Leave"),t()()(),o(4,"ion-content")(5,"div",1)(6,"ion-item")(7,"ion-label",2),m(8,"From Date *"),t(),o(9,"ion-input",3),g("ngModelChange",function(s){return c(e.form.fromDate,s)||(e.form.fromDate=s),s}),t()(),d(10,V,2,0,"ion-text",4),o(11,"ion-item")(12,"ion-label",2),m(13,"To Date *"),t(),o(14,"ion-input",3),g("ngModelChange",function(s){return c(e.form.toDate,s)||(e.form.toDate=s),s}),t()(),d(15,G,2,0,"ion-text",4)(16,K,2,0,"ion-text",4),o(17,"ion-item")(18,"ion-label",2),m(19,"Reason *"),t(),o(20,"ion-textarea",5),g("ngModelChange",function(s){return c(e.form.reason,s)||(e.form.reason=s),s}),t()(),d(21,Q,2,0,"ion-text",4),t()(),o(22,"ion-footer")(23,"ion-toolbar")(24,"ion-button",6),v("click",function(){return e.submit()}),d(25,X,1,0,"ion-spinner",7),m(26," Apply Leave "),t()()()),r&2&&(l(9),f("ngModel",e.form.fromDate),l(),p("ngIf",e.isInvalid("fromDate")),l(4),f("ngModel",e.form.toDate),l(),p("ngIf",e.isInvalid("toDate")),l(),p("ngIf",e.isInvalidDateRange()),l(4),f("ngModel",e.form.reason),l(),p("ngIf",e.isInvalid("reason")),l(3),p("disabled",e.submitting),l(),p("ngIf",e.submitting))},dependencies:[C,M,w,P,S,J,L,E,A,k,W,F,z,B,R,N,j,q,O],styles:[".leave-page[_ngcontent-%COMP%]{--background: #f4f6fb}.leave-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #e0f2fe;--color: #075985;font-weight:700}.form-card[_ngcontent-%COMP%]{padding:16px 16px 100px}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:16px;margin-bottom:18px;box-shadow:0 10px 25px #0000000f}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0 0 14px;font-size:15px;font-weight:600;color:#1f2937}.section-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--ion-color-primary)}ion-item[_ngcontent-%COMP%]{--background: transparent;--highlight-height: 0;--min-height: 52px;border:1px solid #e5e7eb;border-radius:12px;margin-bottom:12px}ion-item.item-has-focus[_ngcontent-%COMP%]{border-color:var(--ion-color-primary)}ion-input[_ngcontent-%COMP%], ion-textarea[_ngcontent-%COMP%]{font-size:14px}ion-textarea[_ngcontent-%COMP%]{--padding-top: 10px}ion-text[color=danger][_ngcontent-%COMP%]{font-size:12px;margin-left:6px;margin-top:4px;display:block}.leave-footer[_ngcontent-%COMP%]{padding:10px 14px;background:#fff;box-shadow:0 -6px 20px #00000014}.leave-footer[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:50px;font-size:15px;font-weight:700;border-radius:14px}"]});let n=a;return n})();export{se as StudentApplyLeavePage};
